<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Site Maintenance | vcl</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Site Maintenance" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Documentation for the Apache VCL (Virtual Computing Lab) project" />
<meta property="og:description" content="Documentation for the Apache VCL (Virtual Computing Lab) project" />
<link rel="canonical" href="http://localhost:4000/site-maintenance.html" />
<meta property="og:url" content="http://localhost:4000/site-maintenance.html" />
<meta property="og:site_name" content="vcl" />
<script type="application/ld+json">
{"url":"http://localhost:4000/site-maintenance.html","headline":"Site Maintenance","description":"Documentation for the Apache VCL (Virtual Computing Lab) project","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=6243282563b85ae3a4b506720eca9e409b53438c">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">

      <h1><a href="http://localhost:4000/">Site Maintenance</a></h1> 


      <h2 id="overview">Overview</h2>

<p>VCL provides a way for scheduling a maintenance window during which the site sill be down for maintenance. This is done through the Site Maintenance section of the site. Users will be alerted for a specified amount of time leading up to the maintenance window that it is coming. A file is created for each scheduled maintenance window on the web server itself. Then, during the maintenance window, the web server can determine that it is within a maintenance window without needing to connect to the database server, allowing maintenance to be done on the database with the web server still showing the message to users. Obviously, if the web server will be taken down for maintenance, the users cannot be shown a maintenance notice during the time the web server is down.</p>

<p><img src="images/progress3.png" width="500" border="1" /></p>

<p>Clicking the <strong>Schedule Site Maintenance</strong> button brings up a dialog for creating a maintenance window.</p>

<p>Start and End days and times are selected for the maintenance window.</p>

<ul>
  <li>
    <p><strong>Inform Hours Ahead</strong> refers to how long before the start time that a notice will be placed at the top of the main content area notifying users of the upcoming maintenance window.</p>
  </li>
  <li>
    <p><strong>Allow Reservations</strong> refers to whether or not users’ reservations will still be available during the maintenance window, and the notice to users is adjusted accordingly. If maintenance will only be done on the VCL core components - the web server, database server, and/or management nodes, users’ reservations would not be interrupted. So, selecting Yes would cause a note to be included in the message to the users saying they will still be able to connect to existing reservations even though they will not be able to view connection information. If maintenance needs to be done on the actual compute nodes, host servers, or networking infrastructure, No should be selected so that the users will be alerted to the fact that they will not have access to their reservations.</p>
  </li>
  <li>
    <p><strong>Reason</strong> is just for administrative purposes to be able to record any notes about what is planned to be done during the maintenance. It is not displayed to the users in any way.</p>
  </li>
  <li>
    <p><strong>User Message</strong> will be displayed during the maintenance window to the users.</p>
  </li>
</ul>

<h3 id="manually-adjusting-the-user-message">Manually Adjusting the User Message</h3>

<p>During the maintenance window, if there is reason to change the message being displayed to users, the file related to the maintenance can be modified. The files are created in the vcl/.ht-inc/maintenance directory and have filenames of the form YYYYMMDDHHmm in relation to the scheduled start time, with YYYY being the year, MM being the month, DD being the day, HH being the hour (24 hour format), and mm being the minute. The first line in each file sets the end time of the maintenance window. Any following lines are considered the User Message and can be adjusted to change what is displayed to users during the maintenance window.</p>

<h3 id="ending-maintenance-early">Ending Maintenance Early</h3>

<p>If you finish your maintenance earlier than the scheduled end time, you can remove your site from being in the maintenance state by removing the file that is created on the web server. Files are automatically removed at the end of the maintenance window anyway. The files are created in the vcl/.ht-inc/maintenance directory and have filenames of the form YYYYMMDDHHmm in relation to the scheduled start time, with YYYY being the year, MM being the month, DD being the day, HH being the hour (24 hour format), and mm being the minute.</p>

<h3 id="manually-placing-the-site-in-maintenance">Manually Placing the Site in Maintenance</h3>
<p>If you find yourself having an event with the database server preventing your site from working, you can manually place the web part of the system in the maintenance state by creating a file in the vcl/.ht-inc/maintenance directory. The file must have a filename of the form YYYYMMDDHHmm in relation to the start time of the maintenance, with YYYY being the year, MM being the month, DD being the day, HH being the hour (24 hour format), and mm being the minute. The contents of the file need to be as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    END=YYYYMMDDHHmm
    Reason for maintenance here.
</code></pre></div></div>

<p>The format of the value for END is the same as the name of the file, except it would match the end time for the maintenance. An example is as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    END=201505271330
    This site is currently down for emergency maintenance.
</code></pre></div></div>

<p>Once things are back in order, simply remove the file to remove the site from the maintenance state.</p>


      
      <div class="footer border-top border-gray-light mt-5 pt-3 text-right text-gray">
        This site is open source. <a href="http://github.com/pathoma4/vcl/edit/gh-pages/SiteMaintenance.md">Improve this page</a>.
      </div>
      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
