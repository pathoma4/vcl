<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>How to Install and Configure xCat | vcl</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="How to Install and Configure xCat" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Documentation for the Apache VCL (Virtual Computing Lab) project" />
<meta property="og:description" content="Documentation for the Apache VCL (Virtual Computing Lab) project" />
<link rel="canonical" href="http://localhost:4000/How-to-Install-and-Configure-xCat.html" />
<meta property="og:url" content="http://localhost:4000/How-to-Install-and-Configure-xCat.html" />
<meta property="og:site_name" content="vcl" />
<script type="application/ld+json">
{"url":"http://localhost:4000/How-to-Install-and-Configure-xCat.html","headline":"How to Install and Configure xCat","description":"Documentation for the Apache VCL (Virtual Computing Lab) project","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=10be2bdb9e2d45aaad3923ff16cd58614101a619">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">

      <h1><a href="http://localhost:4000/">How to Install and Configure xCat</a></h1> 


      <h2 id="ibm-bladecenter-configuration">IBM BladeCenter Configuration</h2>

<h3 id="set-the-boot-order-of-the-blades">Set the boot order of the blades</h3>

<p>The blades need to be configured to attempt to boot from the network before booting from the hard drive.</p>

<ul>
  <li>Log in the the BladeCenter Advanced Management Module</li>
  <li>Select Blade Tasks &gt; Configuration</li>
  <li>Select the Boot Sequence tab:
  <img src="images/BootOrder1.png" width="600" border="1" /></li>
  <li>Click on one of the blade names</li>
  <li>Change the boot order so that Network precedes Hard drive 0:
  <img src="images/BootOrder2.png" width="600" border="1" /></li>
  <li>Select the Apply to all blades checkbox</li>
  <li>Click Save</li>
</ul>

<h3 id="configure-snmpv3">Configure SNMPv3</h3>
<ul>
  <li>Select Login Profiles</li>
  <li>Select a login ID that is not used
  <img src="images/AMMuser0.png" width="600" border="1" /></li>
  <li>Enter a Login ID and password
  <img src="images/AMMuser1.png" width="600" border="1" /></li>
  <li>Under role, select Supervisor</li>
  <li>Click Save</li>
  <li>Click the user which was just created</li>
  <li>Scroll to the bottom and click Configure SNMPv3 User
  <img src="images/AMMuser2.png" width="700" border="1" /></li>
  <li>Enter the username and password of the user and set the rest of the fields as follows (replace 0.0.0.0 with the management node’s control network IP address for security):
  <img src="images/AMMuser3.png" width="600" border="1" /></li>
  <li>Click Save</li>
</ul>

<h2 id="install-xcat">Install xCat</h2>

<p>On the VCL management node:</p>

<h4 id="download-the-xcat-yum-repository-files">Download the xCAT yum repository files:</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget -N -P /etc/yum.repos.d
http://sourceforge.net/projects/xcat/files/yum/xcat-dep/rh6/x86_64/xCAT-dep.repo

wget -N -P /etc/yum.repos.d
http://sourceforge.net/projects/xcat/files/yum/2.8/xcat-core/xCAT-core.repo
</code></pre></div></div>

<h4 id="install-xcat-1">Install xCAT</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    yum clean all
    yum install -y xCAT
</code></pre></div></div>

<h4 id="configure-the-xcat-site-table">Configure the xCAT site table</h4>

<p>Set the “master” and “nameservers” keys in the site table to point to the xCAT management node’s private IP address:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    chtab key=master site.value=x.x.x.x

    chtab key=nameservers site.value=x.x.x.x
</code></pre></div></div>

<p>Set the “forwarders” key in the site table to point to a DNS server:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    chtab key=forwarders site.value=y.y.y.y
</code></pre></div></div>

<p>Set the “dhcpinterfaces” key in the site table to the xCAT management node’s private network interface. This causes the DHCP server running on the management node to only listen on this interface:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    chtab key=dhcpinterfaces site.value=ethX
</code></pre></div></div>

<h4 id="configure-the-xcat-networks-table">Configure the xCAT networks table</h4>

<p>Disable all networks detected by xCAT except the private network so that xCAT does not attempt to add unwanted information to DHCP or other services.  First, dump the contents of the networks table to determine the network names created by xCAT:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    tabdump networks
</code></pre></div></div>

<p>For each network except the private network, run the following command to set the network to disabled:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    chtab netname=&lt;netname&gt; networks.disable=1
</code></pre></div></div>

<h4 id="configure-the-blade-node-group">Configure the blade node group</h4>

<p>Set the nodehm table to use blade control methods:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    chtab node=blade nodehm.mgt=blade
</code></pre></div></div>

<p>Set the noderes table to use the xnba network boot method:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    chtab node=blade noderes.netboot=xnba
</code></pre></div></div>

<p>Set the xCAT master, TFTP, and NFS srever values to point to the xCAT management node’s private IP address:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    chtab node=blade noderes.xcatmaster=x.x.x.x

    chtab node=blade noderes.tftpserver=x.x.x.x
</code></pre></div></div>

<h4 id="configure-the-xcat-passwd-table">Configure the xCAT passwd table</h4>

<p>Set the username and password for the blade key to the credentials used to log in to the Advanced Management Module:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    chtab key=blade passwd.username=&lt;xcatuser&gt; passwd.password=&lt;xcatpassword&gt;
</code></pre></div></div>

<p>Set the root password for the system key. When a Linux image is loaded via Kickstart by xCAT, this will be the root password initially set on the loaded computer:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    chtab key=system passwd.username=root passwd.password=&lt;linuxpassword&gt;
</code></pre></div></div>

<h4 id="add-a-node-to-xcat-for-each-chassis-advanced-management-module">Add a node to xCAT for each chassis Advanced Management Module</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    nodeadd bcamm-X groups=mm

    nodeadd bcamm-Y groups=mm
</code></pre></div></div>

<h4 id="add-a-node-to-xcat-for-every-blade-controlled-by-the-management-node">Add a node to xCAT for every blade controlled by the management node</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    nodeadd vcl-X-1..vcl-X-14 groups=all,blade,compute

    nodeadd vcl-Y-1..vcl-Y-14 groups=all,blade,compute
</code></pre></div></div>

<p>For each blade, set the mp.mpa value to the AMM node name, and mp.id value to the corresponding blade slot</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    for i in {1..14} ; do chtab node=vcl-X-$i mp.mpa=bcamm-X mp.id=$i ; done

    for i in {1..14} ; do chtab node=vcl-Y-$i mp.mpa=bcamm-Y mp.id=$i ; done
</code></pre></div></div>

<p>Set the hosts.ip value to the private IP address for each AMM and blade</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    chtab node=bcamm-X hosts.ip=&lt;x.x.x.x&gt;

    chtab node=vcl-X-1 hosts.ip=&lt;x.x.x.x&gt;

    ...

    chtab node=vcl-Y-14 hosts.ip=&lt;x.x.x.x&gt;
</code></pre></div></div>

<p>Create the /etc/hosts file</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    makehosts -n
</code></pre></div></div>

<p>Retrieve MAC address for each blade</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    getmacs blade -i eth0
</code></pre></div></div>

<p>Initialize DHCP and create a definition for each blade</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    makedhcp -n

    chkconfig dhcpd on

    makedhcp blade
</code></pre></div></div>

<p>Download a CentOS ISO image</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    wget -N -P /install/software
    http://ftp.linux.ncsu.edu/pub/CentOS/6/isos/x86_64/CentOS-6.5-x86_64-bin-DVD1.iso
</code></pre></div></div>

<p>Import the CentOS image into the xCAT install tree</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    copycds /install/software/CentOS-6.5-x86_64-bin-DVD1.iso
</code></pre></div></div>

<p>Configure the blades to install the CentOS using xCAT’s stock “compute” template</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    chdef blade os=centos6.5 arch=x86_64 profile=compute
</code></pre></div></div>

<p>Set the blades to install the image on the next reboot</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    nodeset blade install
</code></pre></div></div>

<p>Power cycle each blade</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    rpower blade boot
</code></pre></div></div>


      
      <div class="footer border-top border-gray-light mt-5 pt-3 text-right text-gray">
        This site is open source. <a href="http://github.com/pathoma4/vcl/edit/gh-pages/HowToInstallandConfigurexCat.md">Improve this page</a>.
      </div>
      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
