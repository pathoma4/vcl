<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>VCL 2.3 Installation | vcl</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="VCL 2.3 Installation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Documentation for the Apache VCL (Virtual Computing Lab) project" />
<meta property="og:description" content="Documentation for the Apache VCL (Virtual Computing Lab) project" />
<link rel="canonical" href="http://localhost:4000/VCL-2.3-installation.html" />
<meta property="og:url" content="http://localhost:4000/VCL-2.3-installation.html" />
<meta property="og:site_name" content="vcl" />
<script type="application/ld+json">
{"headline":"VCL 2.3 Installation","url":"http://localhost:4000/VCL-2.3-installation.html","description":"Documentation for the Apache VCL (Virtual Computing Lab) project","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=6b65d7cee1bec80f4edfd8e2f78e8ccdb263fb8c">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">

      <h1><a href="http://localhost:4000/">VCL 2.3 Installation</a></h1> 


      <h1 id="install--configure">Install &amp; Configure:</h1>

<ol>
  <li><a href="#install-and-configure-the-database">Install and Configure the Database</a></li>
  <li><a href="#install-and-configure-the-web-components">Install and Configure the Web Components</a></li>
  <li><a href="#install-and-configure-the-management-node-components">Install and Configure the Management Node Components</a></li>
  <li><a href="#configure-authentication">Configure Authentication</a></li>
</ol>

<h2 id="install-and-configure-the-database">Install and Configure the Database</h2>

<h3 id="1-download--extract-the-apache-vcl-source">1. Download &amp; Extract the Apache VCL Source</h3>

<ol>
  <li>
    <p>If you have not already done so, download and the Apache VCL source to the database server:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> wget --trust-server-names ''
</code></pre></div>    </div>
  </li>
  <li>
    <p>Extract the files:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> tar -jxvf apache-VCL-2.3.tar.bz2
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="2-install-mysql-server">2. Install MySQL Server</h3>
<ol>
  <li>
    <p>Install MySQL Server 5.x:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> yum install mysql-server -y
</code></pre></div>    </div>
  </li>
  <li>
    <p>Configure the MySQL daemon (mysqld) to start automatically:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> /sbin/chkconfig --level 345 mysqld on
</code></pre></div>    </div>
  </li>
  <li>
    <p>Start the MySQL daemon:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> /sbin/service mysqld start
</code></pre></div>    </div>
  </li>
  <li>
    <p>If the iptables firewall is being used and the web server and management nodes will be on different machines, port 3306 should be opend up</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> vi /etc/sysconfig/iptables


 -A RH-Firewall-1-INPUT -m state --state NEW -s &lt;web server IP&gt; -p tcp --dport 3306 -j ACCEPT
 -A RH-Firewall-1-INPUT -m state --state NEW -s &lt;management node IP&gt; -p tcp --dport 3306 -j ACCEPT
 service iptables restart
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="3--create-the-vcl-database">3.  Create the VCL Database</h3>
<ol>
  <li>
    <p>Run the MySQL command-line client:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mysql
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a database:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> CREATE DATABASE vcl;
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a user with SELECT, INSERT, UPDATE, DELETE, and CREATE TEMPORARY TABLES privileges on the database you just created:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> GRANT SELECT,INSERT,UPDATE,DELETE,CREATE TEMPORARY TABLES ON vcl.* TO 'vcluser'@'localhost' IDENTIFIED BY 'vcluserpassword';
</code></pre></div>    </div>
  </li>
</ol>

<p><strong><em>Replace vcluser and vcluserpassword with that of the user you want to use to connect to the database</em></strong></p>

<p><strong>The GRANT command will automatically create the user if it doesn’t already exist</strong></p>

<ol>
  <li>
    <p>Exit the MySQL command-line client:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> exit
</code></pre></div>    </div>
  </li>
  <li>
    <p>Import the vcl.sql file into the database</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mysql vcl &lt; apache-VCL-2.3/mysql/vcl.sql
</code></pre></div>    </div>

    <p>The vcl.sql file is included in the mysql directory within the Apache VCL source code</p>
  </li>
</ol>

<h2 id="install-and-configure-the-web-components">Install and Configure the Web Components</h2>

<h3 id="prerequisites">Prerequisites</h3>

<p>The following instructions assume these tasks have previously been completed:</p>
<ul>
  <li>
    <p><a href="https://vcl.apache.org/downloads/download.cgi">Apache VCL 2.3 has been downloaded</a></p>
  </li>
  <li>
    <p><a href="VCL-2.3-Database-Installation.html">VCL database has been installed and configured</a></p>
  </li>
</ul>

<h5 id="web-server">Web Server:</h5>

<ul>
  <li>
    <p>Apache HTTP Server v1.3 or v2.x with SSL enabled</p>
  </li>
  <li>
    <p>PHP 5.0 or later</p>

    <div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:
</b> The VCL web frontend may run under other web server platforms capable of running PHP code, but has only been tested to work with Apache HTTP Server.</div>

    <p><strong><em>The VCL web frontend may run under other web server platforms capable of running PHP code, but has only been tested to work with Apache HTTP Server.</em></strong></p>
  </li>
</ul>

<h5 id="required-linux-packages">Required Linux Packages:</h5>

<ul>
  <li>httpd - Apache HTTP Server</li>
  <li>mod_ssl - SSL/TLS module for the Apache HTTP server</li>
  <li>php - The PHP HTML-embedded scripting language</li>
  <li>libmcrypt - Encryption algorithms library (this requirement can be removed with a <a href="Patch-to-remove-mcrypt-dependency.html">patch</a>)</li>
</ul>

<h5 id="required-php-modules">Required PHP Modules:</h5>

<p>Required php Modules:</p>

<ul>
  <li>php-gd</li>
  <li>php-json (required if your PHP version is 5.2 or later)</li>
  <li>php-mysql</li>
  <li>php-openssl</li>
  <li>php-sysvsem</li>
  <li>php-xml</li>
  <li>php-xmlrpc</li>
  <li>php-ldap (if you will be using LDAP authentication)</li>
  <li>php-process (for RHEL/CentOS 6)</li>
</ul>

<h3 id="1-install-the-required-linux-packages--php-modules">1. Install the Required Linux Packages &amp; PHP Modules</h3>

<ol>
  <li>
    <p>If your web server is running a Red Hat-based OS, the required components can be installed with:</p>

    <p>For RHEL / CentOS 5</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     yum install httpd mod_ssl php php-gd php-mysql php-xml php-xmlrpc php-ldap -
</code></pre></div>    </div>

    <p>For RHEL / CentOS 6</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     yum install httpd mod_ssl php php-gd php-mysql php-xml php-xmlrpc php-ldap php-process -y
</code></pre></div>    </div>

    <p><strong><em>You may need the optional server rpm repository for the php-process package to add this run the following command:</em></strong></p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     rhn-channel --add --channel=rhel-x86_64-server-optional-6
</code></pre></div>    </div>
  </li>
  <li>
    <p>Configure the web server daemon (httpd) to start automatically:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> /sbin/chkconfig --level 345 httpd on
</code></pre></div>    </div>
  </li>
  <li>
    <p>Start the web server daemon:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> /sbin/service httpd start
</code></pre></div>    </div>
  </li>
  <li>
    <p>If SELinux is enabled, run the following command to allow the web server to connect to the database:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> /usr/sbin/setsebool -P httpd_can_network_connect=1
</code></pre></div>    </div>
  </li>
  <li>
    <p>If the iptables firewall is being used, port 80 and 443 should be opened up:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> vi /etc/sysconfig/iptables


 -A RH-Firewall-1-INPUT -m state --state NEW -p tcp --dport 80 -j ACCEPT
 -A RH-Firewall-1-INPUT -m state --state NEW -p tcp --dport 443 -j ACCEPT


 service iptables restart
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="2-install-the-vcl-frontend-web-code">2. Install the VCL Frontend Web Code</h3>

<ol>
  <li>
    <p>If you have not already done so, download and extract the source files on the web server:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget --trust-server-names ''

tar -jxvf apache-VCL-2.3.tar.bz2
</code></pre></div>    </div>
  </li>
  <li>
    <p>Copy the web directory to a location under the web root of your web server and navigate to the destination .ht-inc subdirectory:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> cp -r apache-VCL-2.3/web/ /var/www/html/vcl

 cd /var/www/html/vcl/.ht-inc
</code></pre></div>    </div>
  </li>
  <li>
    <p>Copy secrets-default.php to secrets.php:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> cp secrets-default.php secrets.php
</code></pre></div>    </div>
  </li>
  <li>
    <p>Edit the secrets.php file:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> vi secrets.php
</code></pre></div>    </div>

    <ul>
      <li>Set the following variables to match your database configuration:
        <ul>
          <li>$vclhost</li>
          <li>$vcldb</li>
          <li>$vclusername</li>
          <li>$vclpassword</li>
        </ul>
      </li>
      <li>Create random passwords for the following variables:
        <ul>
          <li>$cryptkey</li>
          <li>$pemkey</li>
        </ul>
      </li>
      <li>Save the secrets.php file</li>
    </ul>
  </li>
  <li>
    <p>Run the genkeys.sh</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ./genkeys.sh
</code></pre></div>    </div>
  </li>
  <li>
    <p>Copy <strong>conf-default.php</strong> to <strong>conf.php</strong>:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> cp conf-default.php conf.php
</code></pre></div>    </div>
  </li>
  <li>Modify conf.php to match your site
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     vi conf.php
</code></pre></div>    </div>
    <p><strong>Modify every entry under “Things in this section must be modified”. Descriptions and pointers for each value are included within conf.php.</strong></p>

    <ul>
      <li>COOKIEDOMAIN - set this to the domain name your web server is using or leave it blank if you are only accessing the web server by its IP address</li>
    </ul>
  </li>
  <li>
    <p>Set the owner of the <strong>.ht-inc/maintenance</strong> directory to the web server user (normally ‘apache’):</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> chown apache maintenance
</code></pre></div>    </div>
  </li>
  <li>
    <p>Open the testsetup.php page in a web browser:</p>

    <ul>
      <li>If you set up your site to be “https://my.server.org/vcl/” open https://my.server.org/vcl/testsetup.php</li>
      <li>Debug any issues reported by testsetup.php</li>
    </ul>
  </li>
</ol>

<h3 id="3-log-in-to-the-vcl-website">3. Log In to the VCL Website</h3>

<ol>
  <li>Open the index.php page in your browser (https://my.server.org/vcl/index.php)
    <ul>
      <li>Select Local Account</li>
      <li>Username: admin</li>
      <li>Password: adminVc1passw0rd</li>
    </ul>
  </li>
  <li>Set the admin user password (optional):
    <ol>
      <li>Click User Preferences</li>
      <li>Enter the current password: adminVc1passw0rd</li>
      <li>Enter a new password</li>
      <li>Click Submit Changes</li>
    </ol>
  </li>
</ol>

<h3 id="4-add-a-management-node-to-the-database">4. Add a Management Node to the Database</h3>

<ol>
  <li>Click the Management Nodes link
    <ol>
      <li>Click Add</li>
      <li>Fill in these required fields:
        <ul>
          <li>
            <p><strong>Hostname</strong>: The name of the management node server. This value doesn’t necessarily need to be a name registered in DNS nor does it need to be the value displayed by the Linux hostname command. For example, if you are installing all of the VCL components on the same machine you can set this value to localhost.</p>

            <p><strong>Take note of the value you enter for Hostname. In a later step performed during the management node installation, the value enter for Hostname must match the value you enter for FQDN in the /etc/vcl/vcld.conf file on the management node.</strong></p>
          </li>
          <li><strong>IP address</strong>: the public IP address of the management node</li>
          <li><strong>SysAdmin Email Address</strong>: error emails will be sent to this address</li>
          <li><strong>Install Path</strong>: this is parent directory under which image files will be stored - only required if doing bare metal installs or using VMWare with local disks</li>
          <li><strong>End Node SSH Identity Key Files</strong>: enter /etc/vcl/vcl.key unless you know you are using a different SSH identity key file</li>
        </ul>
      </li>
      <li>Optionally, fill in these fields:
        <ul>
          <li><strong>Address for Shadow Emails</strong>: End users are sent various emails about the status of their reservations. If this field is configured, copies of all of those emails will be sent to this address.</li>
          <li><strong>Public NIC configuration method</strong>: this defaults to Dynamic DHCP - if DHCP is not available for the public interface of your nodes, you can set this to Static. Then, the IP configuration on the nodes will be manually set using Public Netmask, Public Gateway, Public DNS Server, and the IP address set for the computer under Manage Computers</li>
        </ul>
      </li>
    </ol>
  </li>
  <li>
    <p>Click Confirm Management Node</p>
  </li>
  <li>
    <p>Click Submit</p>
  </li>
  <li>Click the Management Nodes link
    <ol>
      <li>Select Edit Management Node Grouping</li>
      <li>Click Submit</li>
      <li>Select the checkbox for your management node</li>
      <li>Click Submit Changes</li>
    </ol>
  </li>
  <li>
    <p>Install &amp; Configure phpMyAdmin (Optional):</p>

    <p><a href="https://www.phpmyadmin.net/">phpMyAdmin</a> is a free and optional tool which allows <a href="https://www.mysql.com/">MySQL</a> to be administered using a web browser. It makes administering the VCL database easier. This tool can be installed on the VCL web server. To install phpMyAdmin, follow the instructions on: <a href="VCL-2.3-phpMyAdmin-Installation-and-Configuration.html">VCL 2.3 phpMyAdmin Installation &amp; Configuration</a></p>
  </li>
</ol>

<p><a href="VCL-2.3-Further-Steps-if-Using-VMware.html">Further steps if using only VMWare</a></p>

<p><a href="VCL-2.3-Further-Steps-if-Using-xCAT.html">Further steps if using xCAT</a></p>

<hr />

<p>Previous Step: <a href="#install-and-configure-the-database">VCL 2.3 Database Installation</a></p>

<p>Next Step: <a href="#install-and-configure-the-management-node-components">VCL 2.3 Management Node Installation</a></p>

<hr />

<h2 id="install--configure-the-management-node-components">Install &amp; Configure the Management Node Components</h2>


      
      <div class="footer border-top border-gray-light mt-5 pt-3 text-right text-gray">
        This site is open source. <a href="http://github.com/pathoma4/vcl/edit/gh-pages/VCL2.3.md">Improve this page</a>.
      </div>
      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
