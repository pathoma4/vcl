<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>How to Remotely Automate and Manage User Groups | vcl</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="How to Remotely Automate and Manage User Groups" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Documentation for the Apache VCL (Virtual Computing Lab) project" />
<meta property="og:description" content="Documentation for the Apache VCL (Virtual Computing Lab) project" />
<link rel="canonical" href="http://localhost:4000/How-to-Remotely-Automate-and-Manage-User-Groups.html" />
<meta property="og:url" content="http://localhost:4000/How-to-Remotely-Automate-and-Manage-User-Groups.html" />
<meta property="og:site_name" content="vcl" />
<script type="application/ld+json">
{"headline":"How to Remotely Automate and Manage User Groups","url":"http://localhost:4000/How-to-Remotely-Automate-and-Manage-User-Groups.html","description":"Documentation for the Apache VCL (Virtual Computing Lab) project","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=8e39195660e6f869e7e96fab88a6f0a9eb1563db">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">

      <h1><a href="http://localhost:4000/">How to Remotely Automate and Manage User Groups</a></h1> 


      <p>managegroups.py is a script for remotely managing VCL user groups. It uses VCL’s XML RPC API to provide an easy command line driven way of doing group management.</p>

<p><em>NOTE: This script requires python 3.x.</em></p>

<h3 id="download-information">Download Information</h3>

<p>managegroups.py is not included in any official releases. You can download it from our subversion repository.</p>

<p><a href="https://svn.apache.org/repos/asf/vcl/sandbox/useful_scripts/managegroups.py">Download managegroups.py</a></p>

<h3 id="available-commands">Available Commands</h3>

<p>Running managegroups.py with no arguments provides help on how to use it. It is used by specifying one of the following commands along with parameters specific to each command.</p>

<ul>
  <li>#addUserGroup - creates a new user group</li>
  <li>#getUserGroupAttributes - gets information about a user group</li>
  <li>#deleteUserGroup - deletes a user group</li>
  <li>#editUserGroup - modifies attributes of a user group</li>
  <li>#getUserGroupMembers - gets members of a user group</li>
  <li>#addUsersToGroup - adds users to a group</li>
  <li>#removeUsersFromGroup - removes users from a group</li>
  <li>#emptyGroupMembership - removes all users currently in a group</li>
</ul>

<h3 id="return-status">Return Status</h3>

<p>These are the possible values of the return status:</p>

<ul>
  <li>0 - successful execution</li>
  <li>1 - missing authentication information</li>
  <li>2 - problem with command line parameters</li>
  <li>3 - for commands that pass in a filename, problems encountered reading the file</li>
  <li>4 - no users specified to add to or remove from a group</li>
  <li>5 - error encountered while performing XML RPC API call</li>
</ul>

<h3 id="return-output">Return Output</h3>

<p>The output of managegroups.py will always start with one of:</p>

<ul>
  <li>SUCCESS: - indicates successful run of the command</li>
  <li>ERROR: - indicates a problem running the command</li>
  <li>WARNING: - indicates a no errors, but possibly unexpected results (i.e. specifying a file when adding users to a group, but the file is empty)
    <ul>
      <li>There is one exception. If you specify a parameter, but omit the argument for it, the option parser used in the script will generate an error. However, in those cases, the return status of the command will always be 2.</li>
    </ul>
  </li>
</ul>

<h3 id="authentication">Authentication</h3>

<p>The script needs to know what userid/password to use and what URL to access. These can either be defined as variables within the script (look at the very top of the file) or specified as parameters on the command line, before specifying which of managegroups’s commands to use.</p>

<p>There are two ways to specify authentication information because some people may prefer to have the password saved in the file, but not in a command line history, while others may prefer to have the password saved in command line history, but not in the file. Any of the authentication options specified on the command line will override any defined in the file.</p>

<p>The options for specifying authentication on the command line are</p>

<ul>
  <li>-u username - log in to VCL site with this user, must be in username@affiliation form</li>
  <li>-p “vclpass” - password used when logging in to VCL site, use quotes if it contains spaces</li>
  <li>-r vclurl - XMLRPC URL of VCL site (it will end with index.php?mode=xmlrpccall - i.e. https://vcl.ncsu.edu/scheduling/index.php?mode=xmlrpccall)</li>
</ul>

<h3 id="addusergroup">addUserGroup</h3>

<p>Use this command to create a new user group.</p>

<p>parameters:</p>

<ul>
  <li>-n name - name of new user group</li>
  <li>-a affiliation - affiliation of new user group</li>
  <li>-o owner - user that will be the owner of the group in username@affiliation form</li>
  <li>-m ManagingGroup - name of user group that can manage membership of the new group</li>
  <li>-i InitialMaxTime - (minutes) max initial time users in this group can select for length of reservations</li>
  <li>-t TotalMaxTime - (minutes) total length users in the group can have for a reservation (including all extensions)</li>
  <li>-x MaxExtendTime - (minutes) max length of time users can request as an extension to a reservation at a time</li>
</ul>

<p>on success, returns;</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    SUCCESS: User group successfully created
</code></pre></div></div>

<h3 id="getusergroupattributes">getUserGroupAttributes</h3>

<p>Use this command to get existing information about a user group’s attributes (it does not include the current membership of the group).
parameters:</p>

<ul>
  <li>-n name - name of an existing user group</li>
  <li>-a affiliation - affiliation of user group</li>
</ul>

<p>on success, returns:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    SUCCESS: Attributes retrieved
</code></pre></div></div>

<p>followed by:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    owner: &lt;user group owner&gt;
    managingGroup: &lt;name of managing user group&gt;
    initialMaxTime: &lt;max allowed initial reservation time&gt;
    totalMaxTime: &lt;total allowed reservation time&gt;
    maxExtendTime: &lt;make time allowed per extension&gt;
</code></pre></div></div>

<h3 id="deleteusergroup">deleteUserGroup</h3>

<p>Use this command to delete an existing user group.
parameters:</p>

<ul>
  <li>-n name - name of an existing user group</li>
  <li>-a affiliation - affiliation of user group</li>
</ul>

<p>on success, returns:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    SUCCESS: User group successfully deleted
</code></pre></div></div>

<h3 id="editusergroup">editUserGroup</h3>

<p>Use this command to modify attributes of an existing user group (it is not used for editing the membership of the group). You can specify any combination of the parameters labeled as optional.
parameters:</p>

<ul>
  <li>-n name - name of an existing user group</li>
  <li>-a affiliation - affiliation of user group</li>
  <li>-N NewName - (optional) new name for the user group</li>
  <li>-A NewAffiliation - (optional) new affiliation for the user group</li>
  <li>-O NewOwner - (optional) new owner for the user group in username@affiliation form</li>
  <li>-M NewManagingGroup - (optional) new user group that can manage membership of the user group in group@affiliation form</li>
  <li>-I NewInitialMaxTime - (optional) new max initial time users in the group can select for length of reservations</li>
  <li>-T NewTotalMaxTime - (optional) new total length users in the group can have for a reservation (including all extensions)</li>
  <li>-X NewMaxExtendTime - (optional) new max length of time users can request as an extension to a reservation at a time</li>
</ul>

<p>on success, returns:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    SUCCESS: User group successfully updated
</code></pre></div></div>

<h3 id="getusergroupmembers">getUserGroupMembers</h3>

<p>Use this command to get the current members of a group. Note that it is possible for a group to have no members.
parameters:</p>

<ul>
  <li>-n name - name of an existing user group</li>
  <li>-a affiliation - affiliation of user group</li>
</ul>

<p>on success, returns:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    SUCCESS: Membership retrieved
</code></pre></div></div>

<p>followed by one user per line in username@affiliation form</p>

<h3 id="removeusersfromgroup">removeUsersFromGroup</h3>

<p>Use this command to remove users from an existing user group.
parameters:</p>

<ul>
  <li>-n name - name of an existing user group</li>
  <li>-a affiliation - affiliation of user group</li>
</ul>

<p>Additionally, at least one of these must be specified:</p>

<ul>
  <li>-l UserList - comma delimited list of users to add (no spaces) in username@affiliation form</li>
  <li>-f filename - name of file containing users to add (one user per line) in username@affiliation form</li>
</ul>

<p>on success, returns:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    SUCCESS: Users successfully removed from group
</code></pre></div></div>

<h3 id="emptygroupmembership">emptyGroupMembership</h3>

<p>Use this command to empty the membership of an existing user group.
parameters:</p>

<ul>
  <li>-n name - name of an existing user group</li>
  <li>-a affiliation - affiliation of user group</li>
</ul>

<p>on success, returns:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    SUCCESS: Users successfully removed from group
</code></pre></div></div>

<h3 id="examples">Examples</h3>
<p>The last example includes the authentication information on the command line. For the other examples, the authentication would have been specified inline in the script. Authentication information was only included in one example to make the others more readable.</p>

<p>Create a new user group with name FallUsers, affiliation Local, admin as the owner, and adminUsers@Local as the managing group:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    managegroups.py addUserGroup -n FallUsers -a Local -o admin@Local -m adminUsers@Local -i 240 -t 360 -x 30
</code></pre></div></div>

<p>Change the name of an existing user group named FallUsers, affiliation Local to be SpringUsers:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    managegroups.py editUserGroup -n FallUsers -a Local -N SpringUsers
</code></pre></div></div>

<p>Add two users specified on the command line to a group:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    managegroups.py addUsersToGroup -n FallUsers -a Local -l student1&lt;at:var at:name="Local,student2" /&gt;Local
</code></pre></div></div>

<p>Add all users in a specified file to a group:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    managegroups.py addUsersToGroup -n FallUsers -a Local -f newusers.txt
</code></pre></div></div>

<p>The file would contain something like the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    userid1@Local
    userid2@Local
    userid3@Local
</code></pre></div></div>

<p>Remove all members of a group:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    managegroups.py emptyGroupMembership -n CS101 -a Local
</code></pre></div></div>

<p>Delete a user group:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    managegroups.py -u admin@Local -p passwordhere -r 'https://your.vcl.site/index.php?mode=xmlrpccall' deleteUserGroup -n CS101 -a Local
</code></pre></div></div>


      
      <div class="footer border-top border-gray-light mt-5 pt-3 text-right text-gray">
        This site is open source. <a href="http://github.com/pathoma4/vcl/edit/gh-pages/HowToRemotelyAutomateAndManageUserGroups.md">Improve this page</a>.
      </div>
      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
